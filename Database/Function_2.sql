The functions were a bit modified (exceptions and if clause)